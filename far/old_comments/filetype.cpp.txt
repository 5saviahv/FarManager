/*
Modify:
  20.02.2006 SVS
    ! У ConvertNameToShort новый параметр - размер для Dest
  06.08.2004 SKV
    ! see 01825.MSVCRT.txt
  09.01.2004 SVS
    + Opt.ExcludeCmdHistory - в историю только то, что вводили с клавиатуры
  12.05.2003 SVS
    ! EditFileTypes() теперь без параметра.
    - BugZ#829 - Траблы с ассоциациями (в реестре пропущен TypeN)...
  09.09.2002 SVS
    - BugZ#627 - зачем показывать меню если только одна ассоциация активна
  26.03.2002 VVM
    ! При запуске программы она не бралась в кавычки, если содержала пробелы
    + Запускаем всегда по полному пути.
  20.03.2002 DJ
    ! если введена пустая маска, выдадим предупреждение, а не будем
      молча закрывать диалог
    ! корректно считаем ширину для описаний, содержащих метасимволы
  20.03.2002 IS
    ! немного const (из-за PrepareOSIfExist)
  18.03.2002 SVS
    ! Мааааханькое уточнение (про историю)
  05.03.2002 DJ
    - передадим размер буфера в SubstFileName
  14.02.2002 VVM
    ! UpdateIfChanged принимает не булевый Force, а варианты из UIC_*
  11.02.2002 SVS
    ! Частичная отмена патча от 25.01.2002 - вернем взад.
  30.01.2002 SVS
    - кривое обрезаение от предыдущего патча.
  29.01.2002 SVS
    - BugZ#272 - метасимволы в ассоциациях файлов
  25.01.2002 SVS
    - Бага с прорисовкой, если в ассоциациях строка предварялась символом "@"
      Вопрос спорный... потому оставим в комментариях...
  28.10.2001 tran 1.30
    - баг в показе меню, при выборе пункта через хоткей редактировался
      не тот, что надо.
  14.08.2001 SVS
    - Проблемы с отрисовкой - когда был амперсанд и он стоял гораздо дальше
      отображаемой области
  13.08.2001 SVS
    - Проблемы с отрисовкой - это все рекурсия нам жизнь поганит
  03.08.2001 SVS
    ! Коррекция размера диалога
    ! Для меню выбора ассоциации и диалога изменения ассоциации используются
      свои собственные темы помощи.
  02.08.2001 IS
    ! Все строковые константы, относящиеся к ассоциациям, хранятся в одном
      месте.
    + Работа с новыми строчками в ассоциациях: alt-f3, alt-f4, ctrl-pgdn
  26.07.2001 SVS
    ! VFMenu уничтожен как класс
  18.07.2001 OT
    ! VFMenu
  06.07.2001 IS
    + Теперь в ассоциациях файлов можно использовать маски исключения, маски
      файлов можно брать в кавычки, маски файлов проверяются на корректность,
      можно использовать точку с запятой в качестве разделителя масок.
    - Убрал непонятный мне запрет на использование маски файлов типа "*.*"
      (был когда-то, вроде, такой баг-репорт).
  25.06.2001 IS
    ! Внедрение const
  18.06.2001 SVS
    ! SubstFileName и ReplaceVariables переехали в новый модуль fnparce.cpp
  06.06.2001 SVS
    ! Mix/Max
  21.05.2001 SVS
    ! Константы MENU_ - в морг
    ! struct MenuData|MenuItem
      Поля Selected, Checked, Separator и Disabled преобразованы в DWORD Flags
  17.05.2001 SVS
    ! Для конструкции !? для строки редактирования добавлен флаг
      DIF_USELASTHISTORY - при однотипных операциях ооох как помогает :-)
  07.05.2001 SVS
    ! SysLog(); -> _D(SysLog());
  06.05.2001 DJ
    ! перетрях #include
  29.04.2001 ОТ
    + Внедрение NWZ от Третьякова
  24.04.2001 DJ
    * обработка @ в ассоциациях IF EXIST
  28.02.2001 IS
    ! "CtrlObject->CmdLine." -> "CtrlObject->CmdLine->"
  27.02.2001 VVM
    ! Символы, зависимые от кодовой страницы
      /[\x01-\x08\x0B-\x0C\x0E-\x1F\xB0-\xDF\xF8-\xFF]/
      переведены в коды.
  14.02.2001 SVS
    ! Модификаторы для !@! и !$! - AFQS
  11.02.2001 SVS
    ! Несколько уточнений кода в связи с изменениями в структуре MenuItem
  14.01.2001 SVS
    + Интелектуальное поведение списка ассоциаций
    + Модификаторы !&, !&~ и !^
  03.11.2000 OT
    ! Введение проверки возвращаемого значения
  02.11.2000 OT
    ! Введение проверки на длину буфера, отведенного под имя файла.
  01.11.2000 IS
    - Имя файла в случае !$! должно быть коротким
  02.09.2000 tran
    - !@!, !#!@! bug
  01.08.2000 SVS
    ! Изменения, касаемые измений в структурах DialogItem
    ! в usermenu конструкция !?<title>?<init>! с расширением переменных среды!
  21.07.2000 IG
    - Bug 15 (не работала комманда executable.exe !.!?ext:?!)
  13.07.2000 SVS
    ! Некоторые коррекции при использовании new/delete/realloc
  11.07.2000 SVS
    ! Изменения для возможности компиляции под BC & VC
  25.06.2000 SVS
    ! Подготовка Master Copy
    ! Выделение в качестве самостоятельного модуля
*/
