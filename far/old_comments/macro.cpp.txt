/*
Modify:
  20.09.2006 SVS
    + Macro: первые приближения "Height" и "Width" (и "[A|P]Panel.Height")
    - Macro: fexist fattr и еже с ними возвращаали фингню, если файла нет. (преобразования, млин)
  01.09.2006 SVS
    - Mantis#151 - [A|P]Panel.UNCPath возвращают в конце символ '\'
    - Mantis#230 - fexist() рулит по маске
    + Panel.FAttr(), Panel.FExist()
  12.07.2006 SVS
    ! kill class int64
  06.07.2006 SVS
    - MCODE_V_ITEMCOUNT & MCODE_V_CURPOS для макросов во вьювере возвращает ерунду, т.к. не __int64
  05.07.2006 IS
    - warnings
  29.05.2006 SVS
    ! немного уточнения в работате Title
  03.05.2006 SVS
    - пусть в панелях "Title" вернет именно то, что написано в заголовке панели
  28.04.2006 SVS
    - Mantis#151 - APanel.UNCPath и PPanel.UNCPath возвращают в конце символ "\"
    - Mantis#142 - Ошибка в fsplit
      Описание  Функция fsplit в макросах возвращает неправильное имя файла в корне плагиновой панели (добавляет префикс плагина).
      $IClip CtrlAltIns $Text fsplit(clip(0,""),4)
  17.04.2006 SVS
    + только логирование
  06.04.2006 AY
    ! GCC
  04.04.2006 SVS
    + MCODE_F_SLEEP (N=Sleep(N)), MCODE_V_FAR_HEIGHT (Far.Height), MCODE_V_DRVSHOWPOS (Drv.ShowPos)
    + MCODE_V_DRVSHOWMODE - Drv.ShowMode - режимы отображения меню выбора дисков
    + MCODE_V_TITLE - Title - заголовок текущего объекта
  17.03.2006 SVS
    ! UnrecogniSed (s -> z)
  16.03.2006 SVS
    ! Уточнение диагностики парсера
  12.03.2006 SVS
    ! Добил Clip (функции 3 и 4)
    - ошибка при проверке условия (подробнее см. 02080.Mix.txt)
  04.03.2006 SVS
    + MCODE_F_CLIP (V=clip(N,S))
    ! Числа в макросах имеют суть __int64
    ! В PanelItem переделаны индексы
  17.01.2006 SVS
    + Panel.SetPos
  22.12.2005 SVS
    - Mantis#70 - FAR молча схлопывается при выполнении команды macro:post Add Dlg.GetValue(2,10)
  07.12.2005 SVS
    + MACRO_USERMENU
  11.10.2005 SVS
    - Траблы с Editor.FileName
  07.10.2005 SVS
    ! Editor.CurStr -> Editor.Value. так точнее будет
    + Dlg.GetValue()
  05.10.2005 SVS
    - После Editor.Set(9,2) не обновляется статусная строка редактора
    + Editor.CurStr - содержимое текущей строки
  19.09.2005 SVS
    + MCODE_V_PPANEL_DRIVETYPE, MCODE_V_APANEL_DRIVETYPE
  24.07.2005 WARP
    ! see 02033.LockUnlock.txt
  11.07.2005 SVS
    - вызов функции... возвращаемое значение ненать.
  05.07.2005 SVS
    + Добавка в макросы - OldVal=Editor.Set(Index,NewVal)
    + Editor.FileName - имя редактируемого файла
    + Viewer.FileName - имя просматриваемого файла
  24.04.2005 AY
    ! GCC
  06.04.2005 SVS
    + b=msave(var)
    + [A|P]Panel.LFN
  02.04.2005 SVS
    - проблемы с panelitemFunc Index=13, совсем забыл что овнер - это ссылка.
  01.04.2005 SVS
    + MCODE_F_PANELITEM, panelitemFunc
  22.03.2005 SVS
    ! в макроса пока отключим сохранение варсов.
  10.03.2005 SVS
    - BugZ#1238 Неверная работа fexist по определённой смене папки
  05.03.2005 SVS
    + KeyMacro::ReadVarsConst() - считывание области глобальных переменных Vars
    + KeyMacro::WriteVarsConst() - запись глобальной такблицы переменных в реестр
  02.03.2005 SVS
    + MCODE_V_FAR_WIDTH (Far.Width)
  15.02.2005 SVS
    + функция "S=itoa(N,Radix)"
  14.02.2005 SVS
    + Добавлены слова "[A|P]Panel.OPIFlags"
      Содержат OpenPluginInfo::Flags для активной и пассивной панели.
      Если панель не плагиновая, то = 0
    + Добавлено слово "CmdLine.Value" - содержимое ком.строки.
    ! Математика получения переменной среды вынесена в функцию environFunc
    ! Математика функций "fattr" и "fexist" вынесены в отдельные функции
      fattrFunc и fexistFunc.
      Пересмотрены в сторону работы не только на реальных панелях.
  11.01.2005 SVS
    - BugZ#1218 - Позиция курсора на панели
  05.01.2005 SVS
    - BugZ#1146 - Информационное сообщение о снятии макроса надо улучшить
  08.12.2004 SVS
    + Dlg.ItemCount, Dlg.CurPos, CmdLine.ItemCount, CmdLine.CurPos
    ! обработка типа контрола вынесена из macro.cpp в dialog.cpp
  11.11.2004 SVS
    + [A|P]Panel.UNCPath
    ! [A|P]Panel.Count переименован в [A|P]Panel.ItemCount
    + В дополнении к [A|P]Panel.ItemCount 2 новых слова:
        "ItemCount" - число элементов в текущем объекте
        "CurPos" - текущий индекс в текущем объекте (начиная с 1)
    + Три обособленных, для редактора:
        "Editor.CurLine"  - текущая строка в редакторе (начиная с 1)
        "Editor.Lines"    - количество строк
        "Editor.CurPos"   - текущая позиция курсора в строке (начиная с 1)
    ! В связи с введением Manager::GetTopModal() пересмотрена обработка
      некоторых обобщенных слов.
    - Падение ФАРа при регистрации в функции KeyMacro::CheckAll()
  10.11.2004 SVS
    + [A|P]Panel.Count, [A|P]Panel.CurPos
    ! для менюх найдем LastModal, иначе фигня... тут, кстати, тоже засада, т.к....
  09.11.2004 SVS
    + MCODE_V_APANEL_TYPE, MCODE_V_PPANEL_TYPE, MCODE_C_APANEL_FILEPANEL, MCODE_C_PPANEL_FILEPANEL
    - Траблы с msgBox() - BugZ#1179 - Функция MsgBox
  17.10.2004 SVS
    + MACRO_FINDFOLDER
  17.09.2004 SVS
    - BugZ#1159 - Нельзя удалить макрос из области Common
  10.09.2004 SVS
    + UCase (MCODE_F_UCASE), LCase (MCODE_F_UCASE)
    - В APanel.SelCount и PPanel.SelCount в подстроке "SelCount" буква 'C' была русской :-(
  26.08.2004 SVS & AN
    ! Пока FrameManager->GetCurrentFrame() == NULL функция KeyMacro::ProcessKey() возвращает FALSE
    - BugZ#1157 - Viewer.State не работает в области Qview
    ! Подготовка для ввдения "Eval" - команда, которая позволит на ходу
      компилировать текстовое представление макроса, вызванного из макроса ;-)
      Например, если в переменной %var содержится "CtrlK Esc", то "$Eval %var"
      подсунет в очередь 2 клавиши - Ctrl-K и Esc.
    - неправильно работает SplitFileName
  06.08.2004 SKV
    ! see 01825.MSVCRT.txt
  06.08.2004 SVS
    ! Новое содержимое fsplitFunc
  05.08.2004 SVS
    - BugZ#359 - Не назначается макрос макрос на Ctrl(Shift/Alt)+MsWheelUp(MsWheelDown)
    + MCODE_V_VIEWERSTATE, MCODE_F_FSPLIT, MCODE_F_MSGBOX, MCODE_C_CMDLINE_EMPTY, MCODE_C_CMDLINE_SELECTED, MCODE_V_DLGITEMTYPE, MCODE_F_RINDEX
    + RestartAutoMacro()
  02.08.2004 SVS
    - BugZ#1148 - Не показывается Sequence макроса
    + "CmdLine.Bof/CmdLine.Eof" - курсор в начале/конце cmd-строки редактирования?
  08.07.2004 SVS
    + MACRO_COMMON
  07.07.2004 SVS & AN
    ! Macro II (в общем то все совсем новое)
  31.05.2004 SVS
    ! выкинем нафиг MCODE_OP_SENDKEY - ненужен
  26.05.2004 SVS
    ! MkTextSequence() - третий параметр - некомпиленный текст макроса
    ! В ReadMacros запоминается исходный текст макроса
    ! В SaveMacros макрос не компилится, а берется исходный текст макроса
    ! Декомпилится только простой макрос и только в момент записи! Это нужно для
      второй версии движка... все равно $If и еже с ним с клавиатуры не введешь.
  11.05.2004 SVS
    + $IClip, IClip - работа с внутренним клипбордом
  14.04.2004 SVS
    - BugZ#1052 - Неправильно работает логика определения где мы сейчас в MainMenu и Menu
  09.02.2004 SVS
    + MCODE_F_SWITCHKBD ($KbdSwitch) - просто переключить раскладку клавиатуры
  25.12.2003 SVS
    - падение ФАРа при повторном использовании макроса - не инициализ. Src
  20.12.2003 IS
    - Падение при выполнении только что записанного макроса после предыдущего изменения
      (Ctrl-., a Ctrl-., Ctrl-~, Ctrl-~ -> падение)
  15.12.2003 SVS
    ! Структура MacroRecord увеличена в размере (задел на будущее)
  14.11.2003 SVS
    + заготовка для Alt-F4 в диалоге настройки макросов - т.с. закомменченная перспектива
  28.10.2003 SVS
    ! Либо есть Work.MacroWORK либо его нет.
    ! Раз уж решили работать только в WORK-области, значит так тому и быть.
      Так же, если в стеке состояний есть что-то - не убираем лок экрана
      Так же, если макрос закончился, то принудительно вернем (если есть)
      предыдущее состояние (из стека состояний)
    + MCODE_C_?PANEL_ROOT
    ! Executing -> MacroState.Executing
    ! Добавлена небольшая проверка на корректность $If
  20.10.2003 SVS
    ! переименование
        KEY_MACRO_EDITSELECTED -> KEY_MACRO_SELECTED
        KEY_MACRO_CHECKEOF     -> KEY_MACRO_EOF
    + Обработка KEY_MACRO_EMPTY и KEY_MACRO_BOF
    ! проверка различных состояний, в зависимости от контекста
      исполнения макроса - Bof, Empty, Eof, Selected
  15.10.2003 SVS
    + GetMacroKeyInfo - информация об очередной макроклавише.
    + Сохранение/восстановление макроокружения.
  13.10.2003 SVS
    ! переименование:
      Opt.KeyMacroRecord1  -> Opt.KeyMacroCtrlDot
      Opt.KeyMacroRecord2  -> Opt.KeyMacroCtrlShiftDot
    - неверно работала запись макроса после отработки диалога параметров - флаги портились
  10.10.2003 SVS
    + добавлена проверка условия выделения в ком.строке для "Selected"
    - Ошибка при декомпиляции макроса - пропадал $Else
  04.10.2003 SVS
    ! Куча переделок - все описание см. 01715.Macro.txt
  26.09.2003 SVS
    ! Переименование
      GetMacroPlainText        -> GetPlainText
      GetMacroPlainTextSize    -> GetPlainTextSize
    ! Изменения в названиях макроклавиш
  22.09.2003 SVS
    + KeyMacro::KeyToBuffer() - поместить код в буфер
    ! KeyMacro::IfCondition() - возвращает int
  12.09.2003 SVS
    + Добавлена функция KeyMacro::GetMacroPlainTextSize() - размер plain-text
  09.09.2003 SVS
    - Переполнение буфера при анализе макроса в функции KeyMacro::ParseMacroString
      Сделаем CurKeyText динамическим
  08.09.2003 SVS
    ! уточнение $Date
    + обработка KEY_MACRO_PLAINTEXT - новый оператор $Text - вставка текста.
  25.08.2003 SVS
    ! Не SendKeysToPlugins, но NoSendKeysToPlugins, иначе нифига не получается.
    - BugZ#903 - неотображение правильного заголовка Title Far'a при макросах
  29.07.2003 SVS
    ! Уточнение логики работы макросов.
    ! Вместо InsidePlugin и NoInsidePlugin вводим SendKeysToPlugins - Передавать плагинам нажатия клавиш из проигрывающего макроса.
    ! По CtrlShift. - записывать макрос _не передавая_ нажатия плагинам, как бы
      исправленое старое повидение
      По Ctrl. - записывать макрос _передавая_ нажатия плагинам, новое повидение.
    + Ввод в действие констант MACROMODE_*
  15.07.2003 SVS
    + Новая опция в настройках макроса - "Enable when plugin active"
    + KeyMacro::CheckInsidePlugin() - "мы внутри плагина?"
    + KeyMacro::DropProcess() - прервать текущий исполняемый макрос.
  21.05.2003 SVS
    - BugZ#900 - ACTL_POSTKEYSEQUENCE вызванная из макроса
  02.05.2003 SVS
    - BugZ#790 - Редактирование макроса самим собой прерывает его исполнение?
    - BugZ#873 - ACTL_POSTKEYSEQUENCE и заголовок окна
    + IsExecutingLastKey() - введем проверку на... "это последняя клавиша макрокоманды?"
  14.04.2003 SVS
    - отвалились несколько post`ов
  17.03.2003 SVS
    ! применим новые флаги FFPOL_*
    - В диалоге назначения нельзя назначить Ctrl-F5 в качестве макроклавиши.
    + Добавим KEY_NONE для "временных" макросов. Т.о. снятие лока будет как и у
      "статик" макросов, т.е. не для последней клавиши, а как бы _после_ последней
      ("последняя" в терминах того, что нам сунул плагин)
  20.02.2003 SVS
    ! Заменим strcmp(FooBar,"..") на TestParentFolderName(FooBar)
  21.01.2003 SVS
    + xf_malloc,xf_realloc,xf_free - обертки вокруг malloc,realloc,free
      Просьба блюсти порядок и прописывать именно xf_* вместо простых.
  13.12.2002 SVS
    - BugZ#699 - Бесконечный цикл при использовании ACTL_POSTKEYSEQUENCE
      Теперь забыли про редактор :-(
  10.12.2002 SVS
    - BugZ#699 - Бесконечный цикл при использовании ACTL_POSTKEYSEQUENCE
      Продолжение эпопеи - отвалился KSFLAGS_DISABLEOUTPUT
  03.12.2002 SVS
    - BugZ#699 - Бесконечный цикл при использовании ACTL_POSTKEYSEQUENCE
  09.11.2002 SVS
    ! В связи с коррекцией "ReturnAltValue" вводим в макросах понятие
      AltXXXXX - т.е. то, что было введено как Alt-Num. Для того, чтобы
      не конвертировать код клавиши в редакторе!
  23.08.2002 SVS
    - Перед юзанием *Buffer* надобы проверить его на NULL, т.к.
      процесс убиения макроса физически не создает буфер
  21.08.2002 SVS
    - Проблемы с компиляцией под VC
  19.08.2002 SVS
    ! При помещении в очередь очередного макроса Executing сразу не
      выставляется (ибо действительно сейчас нет исполнения макроса).
      Начало исполнения - либо Executing==TRUE, либо в очереди есть макро.
    ! Если BufferSize == 1, то память под последовательность не выделяется,
      а сам указатель Buffer используется как переменная типа DWORD, что
      позволяет несколько подсократить накладыне расходы на выделение памяти.
    + KeyMacro::KeyFromBuffer() - юзать ее для получения нужной клавиши из
      буфера
  17.08.2002 SVS
    ! Вместо DI_EDIT в диалоге назначения макроклавиши применен DI_COMBOBOX.
      Это дает юзеру возможность выбрать некоторые клавиши, которые обычными
      средствами не назначишь (Esc, Enter, F1).
      В предопределенном списке клавиша "CtrlDown" нужна для того, чтобы
      можно было бы открыть список не только мышкой, но и с клавиатуры.
    ! AssignMacroKey() возвращает -1 вместо Esc, т.к. это в свете появления
      комбобокса будет правильно (иначе не назначишь клавишу Esc)
  02.06.2002 SVS
    ! Внедрение const
  24.05.2002 SVS
    + Обработка KEY_ALTINS
  18.05.2002 SVS
    ! Возможность компиляции под BC 5.5
  16.05.2002 SVS
    - "KSFLAGS_DISABLEOUTPUT не работает"
  05.05.2002 SVS
    - BugZ#496 - Не работают макросы (про дисаблы)
  15.04.2002 SVS
    - откат обратно.
  12.04.2002 SVS
    ! Уберем #if/#endif - выбор на уровне MAK-файла (технологический патч)
    ! SaveMacros - один параметр
    ! Новая концепция: Macros - это своего рода PROM. Все исполняем через MacroRAM
  03.04.2002 SVS
    - BugZ#426 - Не выдается предупреждение на переопределение макроса
  20.03.2002 DJ
    ! корректная обработка [x] Selection exists для диалогов
  03.03.2002 SVS
    - BugZ#262 - Несколько macro:post в usermenu не работают
  03.03.2002 SVS
    ! Если для VC вставить ключ /Gr, то видим кучу багов :-/
  21.02.2002 SVS
    - BugZ#308. Enter попадает в редактор - дропнем LastRecord в манагере
  05.02.2002 SVS
    ! технологический патч - про сислоги
  16.01.2002 SVS
    - Отвал некоторых клавиш (объяснение в описалове)
  14.01.2002 SVS
    - Макрос на Alt-Буква в панелях не работал.
  10.01.2002 SVS
    ! Немного _KEYMACRO
  03.01.2001 IS
    ! Устранение "двойного отрицания" в GetMacroSettings
  28.12.2001 SVS
    - FAR падал когда срабатывало macro:post ....
      Причина в CheckCurMacroFlags()
  26.12.2001 SVS
    ! Вот теперь точное отображение пункта в ньюсе:
      "[!] При считывании макросов из реестра игнорируются
       макропоследовательности, содержащие ошибки в названии
       клавиш."
      Т.е. учитываются ошибки не только в имена макроклавиши,
      но и в "Sequence". И такой глюкавый макрос не считывается
      в память.
  21.12.2001 SVS
    + MOUSEKEY
  10.12.2001 SVS
    ! Вызовим SetFarTitle(NULL) после завершения исполнения макроса.
  23.11.2001 VVM
    ! Исправление бага при вызове диалога-присваивания макро-клавиши из
      другого диалога. Будем лочить не _последний немодальный_ фрейм. А
      _текущий_ фрейм. (Это может быть как раз диалог)
  05.10.2001 SVS
    - IsProcessAssignMacroKey в диалоге назначения макроса присваивались
      явно, из-за чего не работали CAS F12 CtrlTab после назначения макроса
      в результатах поисковика.
  04.10.2001 SVS
    - лок/унлок после диалога параметров макроса.
  26.09.2001 SVS
    + Полиция 18 - если у "полиции" выставлен 18-й бит - не дать возможности
      писать макросы.
  20.09.2001 SVS
    - остаток экрана при прорисовке, если закончили макрос в плагине (OT)
  14.09.2001 SVS
    - BugZ#9 - окончание
  12.09.2001 SVS
    - BugZ#9 - кусок кода, ответственный за прорисоку редактора по окончания
               макроса перенесен в... PluginsSet::OpenPlugin
  07.09.2001 SVS
    + CheckCurMacroFlags() - проверка флагов текущего _ИСПОЛНЯЕМОГО_ макроса.
    ! Флаги для макросов MFLAGS_* переехали в farconst.hpp
  15.08.2001 SVS
    ! косметика - для собственных нужд (по поводу macro2.?pp)
    ! исключены $StopIf
  09.08.2001 SVS
    + IfCondition() - вернет TRUE/FALSE в зависимости от условия
    + KEY_MACROSTOPIFNOT, KEY_MACROSTOPIF - условное прекращение исполнения
      работы макроса (если условие истино) и куча кондитионов к ним :-)
  31.07.2001 SVS
    ! Убираем костыль про коммит(), ибо он себя изжил...
  25.07.2001 SVS
    ! Во время назначения макроса выставлям флаг IsProcessAssignMacroKey
  25.07.2001 SVS
    - Автостартующие макросы запускались не один раз, а сколько раз мы
      вызывали LoadMacros();
  24.07.2001 SVS
    - не работали автостартующие макросы
  23.07.2001 SVS
    - Костыль и в макросы поставим. По другому не назовешь, блин.
      После окончания работы макроса принудительно рефрешим и комитим
      то, на чем остановились.
  10.07.2001 SVS
    + KEY_MACRO_XLAT - в макросах "$XLat" заменяется на клавишу вызова XLat
  25.06.2001 IS
    ! Внедрение const
  25.06.2001 SVS
    - Баги при отработке строк для $Date
  24.06.2001 SVS
    ! Исправление поведения макросов после 771-го.
  22.06.2001 SVS
    ! Макрокоманды "$Year", "$Month", "$Day", "$Hour", "$Min" и "$Sec" больше
      не поддерживаются и заменены на одну макрокоманду "$Date"
  22.06.2001 SVS
    ! Небольшая доработка проверки макроклавиши
  20.06.2001 SVS
    - Некорретная работа функции PlayKeyMacro(MacroRecord*).
      Теперь бум все делать динамически и "у себя" :-)
    ! Названия функций приведены к более конкретному их назначению:
      PlayKeyMacro -> PostTempKeyMacro
    ! TempMacroType удален за ненадобностью, т.к. для Temp-макросов все равно
      память динамически перераспределяется.
  23.05.2001 SVS
    - неверно заполнялись индексы начал макросов.
  23.05.2001 SVS
    ! "Фокусные" клавиши попадали в диалог назначения макро
    ! Немного ускорения в функции GetIndex() за счет сортированного списка
      макросов и наличия массива индексов.
  22.05.2001 SVS
    - автостартующий макрос не работал - кушался первый кей :-(
      из-за того, что по сути не было автивного модала...
  22.05.2001 tran
    ! по результам прогона на CodeGuard
  16.05.2001 SVS
    + GetCurRecord() - для дампа
  07.05.2001 SVS
    ! SysLog(); -> _D(SysLog());
  06.05.2001 DJ
    ! перетрях #include
  06.05.2001 ОТ
    ! Переименование Window в Frame :)
  05.05.2001 DJ
    + перетрях NWZ
  29.04.2001 ОТ
    + Внедрение NWZ от Третьякова
  25.04.2001 SVS
    + MFLAGS_SELECTION - флаг проверки выделения:
      для панелей - больше одного выделенного объекта,
      для редактора - про блоки.
    ! Код проверки флагов для старта макросов вынесен в функции Check* -
      слишком много повторяющегося кода :-(
    ! Новый диалог настройки макроса - используются 3-х позиционные чекбоксы,
      что позволило "ужать" диалог в размерах.
  05.04.2001 VVM
    + 3 дополнительных области макросов - "Info", "QView", "Tree"
  21.03.2001 SVS
    + Обработка особых клавиш: F1 & Enter
  11.03.2001 SVS
    ! Название MFLAGS_RUNAFTERSTART заменено на MFLAGS_RUNAFTERFARSTART
    + Функция MkTextSequence - формирование строкового представления Sequence
    + проверка на "вводили тоже самое"
    ! изменен диалог - подняли на одну строку вверх :-)
    ! небольшая оптимизация кода.
  28.02.2001 IS
    ! "CtrlObject->CmdLine." -> "CtrlObject->CmdLine->"
  22.02.2001 SVS
    + MFLAGS_DISABLEMACRO - ЭТОТ макрос задисаблен!
    ! Учтем, что символ '~' в начале названия макроса - это задисабленный
      макрос
    + В диалогах про удаление, переназначение добавлена краткая инфа про
      текущий Sequence
  19.02.2001 SVS
    - Затирание диалога параметров макроса (при обновлении панелей)
  30.01.2001 SVS
    - Забыл сделать проверку на код возврата из диалога назначения
  21.01.2001 SVS
    - ошибка в назначении клавиши - учитывался текущий контекст макроса, а
      не стартовый при окончании записи макроса.
  19.01.2001 SVS
    + Зарезервировано: MFLAGS_REUSEMACRO - повторное использование макросов
      Это чуть позже, когда будет механизм линеризации...
      А пока пусть будет :-)
  18.01.2001 SVS
    ! немного оптимизации кода
    + Функции поиска макроклавиши и определения размера этой клавиши
    + Хотелка - выдавать предупреждения, что такая клавиша существует
      или подтверждение желания удалить макроклавишу.
  09.01.2001 SVS
    - Бага с пропаданием диалога назначения во время изменения файловой
      структуры в панелях.
  09.01.2001 SVS
    + Учтем правило Opt.ShiftsKeyRules (WaitInFastFind)
  04.01.2001 SVS
    ! Конкретная переделка некоторых интересненьких функций :-)
    ! Новый диалог назначений клавиши
    ! дополнительные макро - про часы
    + Исключения "NoFolders" и "NoFiles"
  28.12.2000 SVS
    - Бага с исключениями про панели.
  26.12.2000 SVS
    + KeyMacroToText()
    ! Скинируем до END_FARKEY_BASE
    + Обработка спец-макроклавиш.
  25.12.2000 SVS
    ! MFLAGS_ вернулись из plugin.hpp
  23.12.2000 SVS
    ! MFLAGS_ переехали в plugin.hpp
    + int KeyMacro::ParseMacroString(struct MacroRecord *CurMacro,char *BufPtr)
    + int KeyMacro::PlayKeyMacro(struct MacroRecord *MRec)
    + int KeyMacro::PlayKeyMacro(char *KeyBuffer)
  22.12.2000 SVS
    - Отвлекли - забыл сбросить новые 2 флага :-(
  22.12.2000 SVS
    - При неправильно выбранных названиях начинается суматоха :-(
      После 333 патча перестали работать макросы ВЕЗДЕ!
  21.12.2000 SVS
    ! 3-е состояние для типа панелей.
    + LoadMacros(), InitVars(), ReleaseTempBuffer()
    ! ReadMacros - возвращает TRUE или FALSE (все зависит от выделения памяти)
    + TempMacroType, TempMacro - будут использоваться для команд
      MCMD_PLAYRECORD, MCMD_PLAYSTRING.
  21.12.2000 SVS
    - неверно работало считывание параметров по новым ключам
      FilePanels и PluginPanels
  21.12.2000 SVS
    + "убираем утечку памяти  (LockScr)
    ! Функция KeyToText удалена за ненадобностью
    ! структура MacroRecord "сжата"
    + 2 режима работы макросов в панелях:
       MFLAGS_PLUGINPANEL - работаем на панели плагинов
       MFLAGS_FILEPANEL - работаем на файловой панели
      по умолчанию они включены.
  27.09.2000 SKV
    - Don't redraw editor after macro finished if it is hidden.
  10.09.2000 SVS
    ! Исправим ситуацию с макросами в связи с переработаными кодами клавиш
    ! Функция ReadMacros имеет дополнительные аргументы
  10.08.2000 skv
    ! Изменение а GetKey для отработки окончания макро в Едиторе.
  25.07.2000 SVS
    ! Функция KeyToText сделана самосотоятельной - вошла в состав
      FSF
  23.07.2000 SVS
    + Клавиши:
       Ctrl- Shift- Alt- CtrlShift- AltShift- CtrlAlt- Apps :-)
       KEY_LWIN (VK_LWIN), KEY_RWIN (VK_RWIN)
  13.07.2000 SVS
    ! Некоторые коррекции при использовании new/delete/realloc
  11.07.2000 SVS
    ! Изменения для возможности компиляции под BC & VC
  25.06.2000 SVS
    ! Подготовка Master Copy
    ! Выделение в качестве самостоятельного модуля
*/
