/*
Modify:
  04.04.2006 SVS
    ! антураж
  05.10.2005 SVS
    + MenuItem.ShowPos
  24.04.2005 AY
    ! GCC
  29.01.2005 WARP
    ! Небольшой cleanup (см. 01920.vmenu_dialog_cleanup.txt)
  08.12.2004 WARP
    ! Патч для поиска #1. Подробнее 01864.FindFile.txt
  19.11.2004 WARP
    + LastAddedItem
  06.07.2004 SVS
    ! CheckHighlights уехал в приват
  30.06.2004 SVS
    + CheckHighlights() - проверка "есть ли такой хоткей в меню"
  11.05.2004 SVS
    + DialogItemID и пара функция для получения/установки этого DialogItemID
  05.01.2004 SVS
    + VMENU_SELECTPOSNONE - признак того, что SelectPos не выставлен (например, все элементы списка задисаблены)
  05.11.2003 SVS
    + VMENU_CHANGECONSOLETITLE, OldTitle
  20.10.2003 SVS
    + GetPtrTitle() - для диалогов
    ! VMenuCSection -> CSection
  14.10.2003 SVS
    + VMenuCSection
  17.06.2003 SVS
    ! VMenu::CallCount сделаем как LONG
  27.05.2003 SVS
    + VMenu::DrawTitles() - кусок кода, прорисовывающий заголовки вынесен в
      эту функцию. Это бага про
      "DM_LISTSETTITLES не работает, если в листе ни одного элемента."
  10.05.2003 SVS
    ! В VMenu::SortItems() добавлен третий параметр SortForDataDWORD,
      который заставляет делать сортировку только по UserData. По умолчанию
      = FALSE
  22.10.2002 SVS
    + PrevCursorSize, PrevMacroMode - для пред.курсора
  04.10.2002 SVS
    + VMENU_DISABLED - говорит о том, что ВЕСЬ список (как элемент диалога) заблокирован
  30.09.2002 SVS
    ! Цветовые истории (Colors не short, а BYTE и применим новую структуру
      FarListColors для SetColors/GetColors)
  03.09.2002 SVS
    ! функция SortItems имеет доп параметр Offset
  25.06.2002 SVS
    ! Косметика:  BitFlags::Skip -> BitFlags::Clear
  31.05.2002 SVS
    + SetMaxHeight()
  18.05.2002 SVS
    ! MouseDown -> VMENU_MOUSEDOWN
  28.04.2002 KM
    + VMENU_COMBOBOX
    + Меню может быть типа MODALTYPE_VMENU и MODALTYPE_COMBOBOX
  13.04.2002 KM
    - ??? Я не понял зачем в классе свой член SaveScr,
      если в ScreenObj он уже есть. Используя SaveScr из
      ScreenObj удалось избавиться от неперерисовок при
      ресайзинге консоли.
  21.02.2002 DJ
    ! корректная отрисовка списков, имеющих рамку, но не имеющих фокуса
    + функция корректировки текущей позиции в меню
  13.02.2002 SVS
    + Один интересный повторяющийся кусок вынесен в CheckKeyHighlighted()
    + MenuItem.NamePtr
  11.02.2002 SVS
    + Член AccelKey в MenuData и MenuItem
    + BitFlags
    ! у функции UpdateItem() параметр должен быть типа FarListUpdate
  01.12.2001 DJ
    - корректный MenuItem::SetCheck()
  02.12.2001 KM
    + VMOldFlags
  30.11.2001 DJ
    - значение VMENU_COLOR_COUNT приведено в соответствие с действительностью
  06.11.2001 SVS
    ! VMENU_REVERSIHLIGHT -> VMENU_REVERSEHIGHLIGHT
  01.11.2001 SVS
    + немного про "типы" - GetType*()
  13.10.2001 VVM
    ! Теперь меню не реагирует на отпускание клавиши мышки, если клавиша была нажата не в меню.
  10.10.2001 IS
    ! внедрение const
  24.08.2001 VVM
    + void SetExitCode(int Code) - вызывает функцию от предка Modal::
  31.07.2001 KM
    + Проверим, а не выполняется ли какая функа у нас...
      GetCallCount().
  26.07.2001 OT
    Исправления отрисовки ShiftF10-F1-AltF9
  26.07.2001 SVS
    ! VFMenu уничтожен как класс
  18.07.2001 OT
    ! Новый класс VFMenu. Добавлены константы, позоляющие ресайзить меню
  30.06.2001 KM
    + SetSelectPos(struct FarListPos *)
  + GetSelectPos(struct FarListPos *)
  29.06.2001 SVS
    + Новый параметр у FindItem - флаги
  25.06.2001 IS
    ! Внедрение const
  14.06.2001 SVS
    ! число -> VMENU_COLOR_COUNT
  10.06.2001 SVS
    + FindItem с двумя параметрами.
  04.06.2001 SVS
    ! Уточнение структуры MenuItem
  03.06.2001 KM
    + Функции SetTitle, GetTitle, GetBottomTitle.
  03.06.2001 SVS
    ! переделка MenuItem
    + GetPosition() - возвращает реальную позицию итема.
    + GetUserDataSize() - получить размер данных
    + SetUserData() - присовокупить данные к пункту меню
    ! GetUserData() - возвращает указатель на сами данные
  30.05.2001 OT
    - Проблемы с отрисовкой VMenu. В новом члене Frame *FrameFromLaunched
      запоминается тот фрейм, откуда это меню запускалось.
      Чтобы потом он не перерисовавался, когда его не просят :)
  25.05.2001 DJ
   + SetOneColor()
  21.05.2001 SVS
   ! VMENU_DRAWBACKGROUND -> VMENU_DISABLEDRAWBACKGROUND
   ! MENU_* выкинуты
   ! DialogStyle -> VMENU_WARNDIALOG
   ! struct MenuData
     Поля Selected, Checked и Separator преобразованы в DWORD Flags
   ! struct MenuItem
     Поля Selected, Checked, Separator и Disabled преобразованы в DWORD Flags
  18.05.2001 SVS
   ! UpdateRequired -> VMENU_UPDATEREQUIRED
   ! DrawBackground -> VMENU_DRAWBACKGROUND
   ! WrapMode -> VMENU_WRAPMODE
   ! ShowAmpersand -> VMENU_SHOWAMPERSAND
   + Функции InsertItem(), FindItem(), UpdateRequired(), GetVMenuInfo()
  17.05.2001 SVS
   + UpdateItem()
   + FarList2MenuItem()
   + MenuItem2FarList()
   + MenuItem.AmpPos - позиция автоназначенной подсветки - для того, чтобы
     вернуть владельцу листа те данные, которые он передавал!
  12.05.2001 SVS
   + AddItem(char *NewStrItem);
  07.05.2001 SVS
   + AddItem, отличается тем, что параметр типа struct FarList - для
     сокращения кода в диалогах :-)
   + SortItems() - опять же - для диалогов
   * Изменен тип возвращаемого значения для GetItemPtr() и убран первый
     параметр функции - Item
  06.05.2001 DJ
   ! перетрях #include
  20.01.2001 SVS
   + SetSelectPos() - установить позицию курсора!
  20.09.2000 SVS
   + Функция GetItemPtr - получить указатель на нужный Item.
  01.08.2000 SVS
   + В ShowMenu добавлен параметр, сообщающий - вызвали ли функцию
     самостоятельно или из другой функции ;-)
   ! Вызов конструктора
   ! ListBoxControl -> VMFlags
   + Флаги для параметра Flags в конструкторе
   + функция обработки меню (по умолчанию)
   + функция посылки сообщений меню
   + функция удаления N пунктов меню
   ! Изменен вызов конструктора для указания функции-обработчика!
  28.07.2000 SVS
   + Добавлены цветовые атрибуты (в переменных) и функции, связанные с
     атрибутами:
  22.07.2000 SVS
   !  AlwaysScrollBar изменен на ListBoxControl
  18.07.2000 SVS
    + Добавлена переменная класса AlwaysScrollBar, предназначенная
      для отображения (всегда, по мере надобности!) в элементах
      DI_LISTBOX & DI_COMBOBOX
    ! В связи с этим изменен вызов конструктора класса.
  25.06.2000 SVS
    ! Подготовка Master Copy
    ! Выделение в качестве самостоятельного модуля
*/
