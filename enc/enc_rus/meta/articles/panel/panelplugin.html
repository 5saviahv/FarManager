<html>

<head>
<meta http-equiv="Content-Type" Content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../styles/styles.css">

<title>Desktop. Пишем плагин</title>
</head>

<body>

<div class=navbar>
<a href="../../index.html">главная</a> |
<a href="../index.html">статьи</a>
</div>

<a name="top"></a>
<h1>Desktop. Пишем плагин</h1>
<div class=navbar>Введение &#187; <a href="panelplugin.1.html">Шаг 1</a> &#187; <a href="panelplugin.2.html">Шаг 2</a> &#187; <a href="panelplugin.3.html">Шаг 3</a></div>
<div align=right>
</div>
<hr color="#003399">

<p>За основу написания плагина возьмем идею:</p>

<blockquote>
  <p><em>Иногда я выкладываю рабочие файлы и папки на
  Desktop`е.<br>
  И если я хочу отобразить на панели FAR это дело, то
  приходится пройти путь<br>
  <code>C:-&gt;Windows-&gt;Profiles-&gt;user-&gt;Desktop-&gt;My Folder</code><br>
  Возможно ли создание плагина для FAR, который
  добавлял бы пункт DeskTop <br>
  (для текущего пользователя) в меню выбора
  диктоводов?</em></p>
</blockquote>

<p>По своей сути данный плагин особой ценности не
представляет - для этой цели лучше использовать
комбинацию клавишь RightCtrl-1..0. Но в качестве
учебного пособия - это то, что надо.</p>

<p>Весь процесс написания разобъем на несколько
шагов. На каждом шаге будем получать
рабоспособный, отвечающий поставленным целям
плагин.</p>

<p>&nbsp;

<dl>
  <dt><a href="panelplugin.1.html">Шаг1: Первое приближение</a></dt>
  <dd>Полная реализация идеи. Информацию о
    местоположении Доски пользователя берем из
    реестра - <b>HCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell
    Folders\Desktop</b>. Имеется так же возможность задания
    конкретного каталога для перехода (не только Desktop
    текущего пользователя) - достигается путем
    введения блока конфигурирования плагина. Этим
    самым &quot;конкретным каталогом&quot; может быть
    каталог, в котором лежит куча LNK-файлов (см. плагин
    &quot;Shell link creation&quot;)...<br>
    На данном шаге плагин не создает собственной
    панели.<br>
  </dd>
  <dt><a href="panelplugin.2.html">Шаг2: Файловая панель</a></dt>
  <dd>Добавляем к предыдущему варианту плагина
    собственную панель, эмулирующую файловую
    систему. На данном шаге файловая панель
    функционирует в режиме Read Only (ни добавлять ни
    удалять с панели мы еще не умеем). Ссылки на
    каталоги представлены в виде файлов. Каталоги на
    панели - виртуальные папки для хранения ссылок на
    реальные каталоги. В корне виртуальной файловой
    системы располагаются 3 объекта - 2 папки и ссылка
    на каталог по умолчанию: <ol>
      <li><b>[Shell Folders]</b><br>
        Здесь &quot;файлы&quot; - пункты из ветви реестра
        HCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</li>
      <li><b>[FolderShortcuts]</b><br>
        Здесь &quot;файлы&quot; - пункты из ветви реестра
        HCU\Software\Far\FolderShortcuts</li>
      <li>&lt;Default Dir&gt;</li>
    </ol>
    <p>При вызове плагина из меню дисков происходит
    переход в каталог по умолчанию. При вызове из
    меню плагинов - эмулируемая файловая панель.
    Выбор каталога по умолчанию осуществляется
    клавишей F7.</p>
  </dd>
  <dt><a href="panelplugin.3.html">Шаг3: Окончательный вариант</a></dt>
  <dd>Расширим функциональность предыдущего
    варианта - дадим возможность пользователю самому
    решать какие ссылки на каталоги должны хранится
    на панели. Создание/удаление каталогов на панели.
    Создание/ Копирование/ Перемещение/ Удаление
    ссылок на &quot;любимые&quot; папки - работа как с
    обычными файлами.</dd>
</dl>

<div align=right><code>
<br>
</code></div>
<div class=seecont><a href="#top">наверх</a></div>

</body>
</html>
