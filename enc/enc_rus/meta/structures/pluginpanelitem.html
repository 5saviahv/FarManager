<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>PluginPanelItem</title>
<meta http-equiv="Content-Type" Content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../styles/styles.css">
<script language="javascript" src='../links.js' type="text/javascript"></script>
</head>

<body>

<h1>PluginPanelItem</h1>
<div class=navbar>
<a href="../index.html">главная</a> |
<a  href="index.html">структуры</a><br>
</div>

<div class=shortdescr>
Структура <dfn>PluginPanelItem</dfn> описывает элемент файловой системы в файловой системе
эмулируемой плагином. Она используется для возвращения информации о файловой системе плагина и
для передачи плагину списка файлов для обработки.
</div>

<p class=note><img src="../../images/warning.gif" alt="ВНИМАНИЕ!" width="10" height="10"> ВНИМАНИЕ!</p>
<UL class=note><LI>
Размер структуры <dfn>PluginPanelItem</dfn> должен быть равен 366 байтам.
Подробности в статье Игоря Павлова "<a href="../articles/alignment.html">Как настроить Alignment</a>"
</LI></UL>


<pre class=syntax>
struct PluginPanelItem
{
#ifndef _FAR_USE_WIN32_FIND_DATA
  struct FAR_FIND_DATA   FindData;
#else
  WIN32_FIND_DATA FindData;
#endif
  DWORD PackSizeHigh;
  DWORD PackSize;
  DWORD Flags;
  DWORD NumberOfLinks;
  char *Description;
  char *Owner;
  char **CustomColumnData;
  int CustomColumnNumber;
  DWORD_PTR UserData;
  DWORD CRC32;
  DWORD Reserved[2];
};
</pre>
<h3>Элементы</h3>
<div class=descr>
  <div class=dfn>FindData</div>
  <div class=dfndescr>Структура FindData содержит много файловых
    параметров. См. описание структуры <a href="../winapi/win32_find_data.html">WIN32_FIND_DATA</a>
    для более подробной информации.</div>
  <div class=dfn>PackSizeHigh</div>
  <div class=dfndescr>Содержит старшие 4 байта упакованного размера файла, в байтах. Сейчас не используется.</div>
  <div class=dfn>PackSize</div>
  <div class=dfndescr>Содержит младшие 4 байта упакованного размера файла, в байтах.</div>
  <div class=dfn>Flags</div>
  <div class=dfndescr>Может быть комбинацией следующих значений (перечисление <a name="PLUGINPANELITEMFLAGS">PLUGINPANELITEMFLAGS</a>):
    <table class="cont">
    <tr class="cont"><th class="cont" width="40%">Флаг</th><th class="cont" width="60%">Описание</th></tr>
      <tr class="cont"><td class="cont" width="40%"><a name="PPIF_PROCESSDESCR">PPIF_PROCESSDESCR</a></td>
      <td class="cont" width="60%">Использовать внутреннюю обработку описаний FAR'а.
        Этот флаг может быть установлен для обрабатываемых файлов в
        функциях  <a href="../exported_functions/deletefiles.html">DeleteFiles</a>,
        <a href="../exported_functions/getfiles.html">GetFiles</a> и
        <a href="../exported_functions/putfiles.html">PutFiles</a>.
        В этом случае FAR будет обновлять файлы описаний с именами,
        возвращенными в функции <a href="../exported_functions/getopenplugininfo.html">GetOpenPluginInfo</a>.
      </td></tr>

      <tr class="cont"><td class="cont" width="40%"><a name="PPIF_SELECTED">PPIF_SELECTED</a></td>
      <td class="cont" width="60%">Для <a href="../service_functions/control.html">Control</a>, в функциях FCTL_GETPANELINFO,
        FCTL_GETANOTHERPANELINFO, FCTL_SETSELECTION и FCTL_SETANOTHERSELECTION этот флаг позволяет
        проверить и установить выделение элементов.<br>
        В функциях <a href="../exported_functions/putfiles.html">PutFiles</a>, <a href="../exported_functions/getfiles.html">GetFiles</a>
        и <a href="../exported_functions/processhostfile.html">ProcessHostFile</a>, если операция не удалась,
        но часть файлов была успешно обработана, плагин может убрать выделение только с
        обработанных файлов.<br>
        Для этого плагин должен очистить флаг PPIF_SELECTED у обрабатываемых элементов в переданном функции списке <i>PluginPanelItem</i>.
      </td></tr>

      <tr class="cont"><td class="cont" width="40%"><a name="PPIF_USERDATA">PPIF_USERDATA</a></td>
      <td class="cont" width="60%">Если этот флаг установлен, FAR считает поле <i>UserData</i> указателем на структуру пользовательских данных.
        Читайте описание <i>UserData</i> для уточнения информации.
        <p>Младшее слово параметра Flags может быть использовано плагином для своих собственных флагов.
      </td></tr>
      </table>
  </div>

  <div class=dfn>NumberOfLinks</div>
  <div class=dfndescr>Количество жестких связей.</div>
  <div class=dfn>Description</div>
  <div class=dfndescr>Указывает на описание файла. Плагин может использовать это поле для передачи описания файла
    FAR'у. Если вы не хотите указывать описания, установите <i>Description</i> в NULL. Если плагин
    использует стандартную обработку описаний FAR'а, и передал имена описаний FAR'у в функции <a href="../exported_functions/getopenplugininfo.html">GetOpenPluginInfo</a>, это поле также должно быть NULL.</div>
  <div class=dfn>Owner</div>
  <div class=dfndescr>Указывает на имя владельца файла. Плагин может использовать это поле для передачи имен владельцев файлов FAR'у.
    Если Вам это не нужно, установите это поле в NULL.</div>
  <div class=dfn>CustomColumnData</div>
  <div class=dfndescr>Указывает на массив адресов строк для определенных плагином типов колонок. Первая строка содержит
    данные для типа колонки C0, вторая - для C1 и т.д. Может быть задано до 10 дополнительных типов колонок от <b><code>C0</code></b>
    до <b><code>C9</code></b>. Если вы не нуждаетесь в дополнительных типах колонок, установите
    это поле в NULL.</div>
  <div class=dfn>CustomColumnNumber</div>
  <div class=dfndescr>Число строк с данными о дополнительных типах колонок.</div>
  <div class=dfn>UserData</div>
  <div class=dfndescr>Это поле может быть использовано плагином для хранения 32-битного значения или указателя на структуру данных.
    В последнем случае, когда <i>UserData</i> указывает на структуру данных, первое поле
    этой структуры должно быть 32-битным значением, равным размеру структуры, и плагин должен установить флаг PPIF_USERDATA в
    поле <i>Flags</i>. Это позволит FAR'у правильно скопировать структуру во внутренний буфер FAR'а
    и позже передать ее плагину в списках <i>PluginPanelItem</i>. В функции <a href="../exported_functions/freefinddata.html">FreeFindData</a> плагин должен освободить память,
    занятую такими дополнительными структурами.</div>
  <div class=dfn>CRC32</div>
  <div class=dfndescr>Контрольная сумма. FAR не использует это поле.</div>
  <div class=dfn>Reserved</div>
  <div class=dfndescr>Зарезервировано для будущего использования. Установите в 0.</div>
</div>

<h3>Замечания</h3>
<div class=descr>
<ol>
<li>Все данные, выделенные плагином для членов <var>Description</var>,
  <var>Owner</var> и <var>CustomColumnData</var>, должны быть освобождены им.
  FAR создает копии этих данные в своих внутренних структурах. Таким образом
  они могут быть освобождены в любой момент после передачи FAR'у в
  функции <a href="../exported_functions/getfinddata.html">GetFindData</a>.

<li>Если плагин использует, например, <var>UserData</var> для получения данных о
   файле, то плагинописатель должен удостовериться в валидности этих
   данных. Это связано с тем, что при вызове <a href="../exported_functions/getfiles.html">GetFiles</a>
   из списка найденных файлов  FAR передает плагину элементы  <dfn>PluginPanelItem</dfn>
   только с одним правильно заполненным членом - <var>FindData</var>, остальные
   члены установлены в <code>NULL</code>.

</ol>
</div>

<div class=see>Смотрите также:</div><div class=seecont>
<a href="index.html">структуры</a> |
<a href="../defs/_far_use_win32_find_data.html">_FAR_USE_WIN32_FIND_DATA</a> |
<a href="../defs/far_find_data.html">FAR_FIND_DATA</a> |
<a href="../delphi/tpluginpanelitem.html">TPluginPanelItem</a>
</div>


</body>
</html>