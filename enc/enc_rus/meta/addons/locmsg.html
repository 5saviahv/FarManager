<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<title>LocMsg</title>
<meta http-equiv="Content-Type" Content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../styles/styles.css">
<script language="javascript" src='../links.js' type="text/javascript"></script>
<meta NAME="Author" content="Ivan Sintyurin">
<meta NAME="Lang" content="C/C++">
<meta NAME="Func" content="LocMsg">
</head>

<body>

<h1>LocMsg</h1>
<div class=navbar>
<a href="../index.html">главная</a> |
<a href="index.html">дополнения</a><br>
</div>


<div class=shortdescr>
Функция <dfn>LocMsg</dfn> возвращает указатель на строку в соответствии с
языковыми настройками FAR Manager. Является аналогом стандартной функции
<a href="../service_functions/getmsg.html">GetMsg</a>.

<p class=note><img src="../../images/caution.gif" alt="Внимание!" width="10" height="10"> Внимание!</p>
<UL class=note><LI>Функция <dfn>LocMsg</dfn> не входит в стандартное API. Исходный текст функции <a href="LocMsg.cpp.txt">см. здесь</a></LI></UL>
</div>

<pre class=syntax>
char *LocMsg(
  struct PluginStartupInfo *psi,
  char *MsgName,
  char *Var,
  int Len
);
</pre>

<h3>Параметры</h3>
<div class=descr>
    <div class=dfn>psi</div>
    <div class=dfndescr>Указатель на структуру <a href="../structures/pluginstartupinfo.html">PluginStartupInfo</a>;
      из этой структуры берутся переменные RootKey и ModuleNumber.</div>
    <div class=dfn>MsgName</div>
    <div class=dfndescr>название нужного сообщения</div>
    <div class=dfn>Var</div>
    <div class=dfndescr>если не NULL, то сюда копируется полученная строка</div>
    <div class=dfn>Len</div>
    <div class=dfndescr>если = 0, то копируется столько, сколько есть</div>

</div>

<h3>Возвращаемое значение</h3>
<div class=descr>
  Указатель на строку, содержащую данные.
</div>

<h3>Замечания</h3>
<div class=descr>
<ol>
  <li>В отличии от функции <a href="../service_functions/getmsg.html">GetMsg</a>, данная функция
  не кэширует данные, что позволяет динамически (без перезагрузки FAR Manager)
  менять данные и т.п.
  <li>Функция LocMsg позволяет также применять
  "<a href="../articles/localization.html">локализацию</a>" к плагинам
  "второго уровня", которые "урезаны в своих правах"...
  <li>Учитываются настройки конкретных пользователей - фича FAR 1.63
  <li>Файл с сообщениями (располагается в каталоге с плагином) должен
  называться <b>ИмяПлагина.msg</b>  и является
  обыкновенным ini-файлом. Его структура такова:
<pre class=code>[Default]
//Данная секция сообщает из какой секции брать строки, если в
//данном файле не найдено требуемой языковой секции. Данная секция
//может отсутствовать, в этом случае языковой секцией по умолчанию
//считается первая.
Language=Russian

//Далее идет описания языковых секций.
//Названия ДОЛЖНЫ формироваться следующим образом:
//В lng-файлах первая строка такая
//.Language=Russian,Russian (Русский)
//          ^^^^^^^
//А вот так должна называться языковая секция

[Russian]
String1=Текст первого сообщения
String2=Текст второго сообщения
IsSkipNoWord=1

[English]
String1=Text of the first message
String2=Text of the second message
IsSkipNoWord=1
//и т.д.
</pre>
</ol>
</div>

<h3>Пример</h3>
<div class=descr>
<pre class=code>  BOOL IsSkipNoWord;
  p=LocMsg("IsSkipNoWord",NULL,1);
  IsSkipNoWord=(*p != '0')?TRUE:FALSE;

  phf=strrchr(LocMsg(temp,"String1",956),".");
</pre>

</div>

<div class=see>Смотрите также:</div><div class=seecont>
<a href="../service_functions/getmsg.html">GetMsg</a> |
<a href="../language/language_files.html">Языковые файлы</a> |
<a href="../articles/localization.html">"Локализация плагинов второго уровня"</a>
</div>
</body>
</html>