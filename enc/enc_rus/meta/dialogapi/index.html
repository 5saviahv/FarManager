<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>Dialog API 1.0</title>
<meta http-equiv="Content-Type" Content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../styles/styles.css">
<script language="JavaScript" src='../links.js' type="text/javascript"></script>
</head>

<body>

<h1>Dialog API 1.0</h1>
<div class=navbar>
<a href="../index.html">главная</a>
</div>


<p class=note><img src="../../images/note.gif" alt="Внимание!" width="10" height="10"> Внимание!</p>
<UL class=note><LI>Все детали по Dialog API написаны с учетом именованных объединений
структуры <a href="structures/fardialogitem.html">FarDialogItem</a>.
Более подробно читайте в описании определения
<a href="../defs/_far_no_nameless_unions.html">_FAR_NO_NAMELESS_UNIONS</a>.</LI></UL>

<div class=shortdescr>
<p>DialogAPI выделен в отдельное API, начиная с версии FAR Manager 1.70. Что
это значит для плагинописателей? Самое главное - максимальный контроль над
созданным диалогом.
<p>Различаются два типа диалогов:<ul>
<li>Диалоги так называемого About стиля (времен FAR 1.65 и ниже)
<li>Диалоги Extended стиля - те, которые используют функцию-обработчик диалога.
</ul>
<p>Независимо от стиля, Менеджер диалогов версии 1.0 поддерживает только так
называемые <b>Модальные Диалоги</b> (Modal Dialog). Модальный диалог
представляет собой окно, запрещающее пользователю взаимодействовать с любым
объектом FAR Manager вне данного диалога. Модальный диалог отсекает поток
сообщений, идущих от мыши или клавиатуры к другим объектам FAR Manager.
</div>

<h3>About стиль</h3>
<div class=descr>
Здесь все просто - НЕУПРАВЛЯЕМЫЕ ДИАЛОГИ! Такие диалоги получаются при вызове
функции <a href="dialog.html">Dialog</a> или <a href="dialogex.html">DialogEx</a>
с параметром <dfn>DlgProc</dfn>, равным NULL.
<p>Данный стиль предполагает следующее поведение диалога:
<ul>
<li>о любых изменениях в состоянии управляющих элементов плагин узнает только
    после выхода из диалога;
<li>выход из диалога происходит, когда пользователь нажал одну из клавиш:
    <code>Esc</code>, <code>Ctrl-Enter</code>, <code>Enter</code>
    (нажатие <code>Enter</code> приводит к выходу из диалога на любом
    элементе, кроме строк редактирования, объединенных флагом
    <a href="flags/dif_editor.html">DIF_EDITOR</a>),
    или кликнул кнопкой мыши за пределами диалога;
<li>данный стиль предназначен для простых диалогов.
</ul>
</div>

<h3>Extended стиль</h3>
<div class=descr>
А вот это...  это самое интересное! Плагин полностью управляет поведением
диалога:<ul>
<li>диалог имеет функцию-обработчик, которая реагирует на массу событий,
    приходящих от Менеджера диалогов;
<li>функция-обработчик общается с Менеджером Диалогов путем посылки
    <a href="dmsg/index.html">сообщений</a>, используя функцию
    <a href="senddlgmessage.html">SendDlgMessage</a>;
<li>функция-обработчик может передать управление Менеджеру Диалогов используя
    функцию <a href="defdlgproc.html">DefDlgProc</a>;
<li>если пользователь пытается взаимодействовать с недоступными объектами
    FAR Manager, нажимая на кнопки мыши вне диалога, то Менеджер Диалогов
    предупреждает гудком;
<li>окончанием обработки диалога управляет плагин.
<li>данный стиль предназначен для диалогов со сложной логикой взаимодействия с
    пользователем.
</ul>
Если в обработчике диалога просто передать управление ядру посредством
функции <a href="defdlgproc.html">DefDlgProc</a>, то получим... тот же About-стиль:
<pre class=code>
// минимальный обработчик диалога
LONG_PTR WINAPI MyDlgProc(HANDLE hDlg,int Msg,int Param1,LONG_PTR Param2)
{
  return Info.DefDlgProc(hDlg,Msg,Param1,Param2);
}
</pre>
</div>

<p>Критерии выбора стиля диалога просты:
<ul>
<li>создаем диалог для ввода одной строки (типа
    <a href="../service_functions/inputbox.html">InputBox</a>) -
    выбираем простой стиль (About) - проще программа, меньше написанного кода, меньше
    ошибок;
<li>создаем Game-Plugin, Калькулятор или плагин взаимодействующий с
  базой данных через ODBC - выбираем Extended стиль - сложная логика,
  динамика, интерактивное взаимодействие с пользователем, от действий которого
  зависит дальнейшая обработка, etc...
</ul>

<p>Итак. Dialog API версии 1.0:</p>
<div class=descr>
<a href="function.html">Функции</a><br>
<a href="structures/index.html">Структуры</a><br>
<a href="defs/index.html">Макросы и типы</a><br>
<a href="controls/index.html">Элементы диалога</a><br>
<a href="flags/index.html">Флаги элементов диалога</a><br>
<a href="dmsg/index.html">События и сообщения</a><br>
<a href="keybfocus.html">Фокус ввода</a><br>
<a href="lists4.html">Механизмы работы со списками</a><br>
</div>

<p>&nbsp;</p>
<h3>Примечание</h3>
<div class=descr>
Для ознакомления с Dialog API рекомендуется изучить файл <code>dialog.cpp</code>
из плагина
"<a href="http://plugring.farmanager.com/downld/files/reversi.zip">Reversi</a>".
</div>


<div class=see>Смотрите также:</div><div class=seecont>
<a href="../exported_functions/index.html">Экспортируемые функции</a>,
<a href="../service_functions/index.html">Сервисные функции</A>,
<a href="../structures/index.html">Структуры</A>,
<a href="../customapi/index.html">Поддержка архивов</A>,
<a href="../addons/index.html">Дополнения</a>
</div>

</body>
</html>